#include "ReadWriter.h"
//iostream, fstream включены в ReadWriter.h
using namespace std;

//Можно создавать любое количество любых вспомогательных классов, структур и методов для решения задачи.
int heap_size;

int left(int i) {
    return 2 * i + 1;
}

int right(int i) {
    return 2 * i + 2;
}

void heapify(int *numbers, int i, int array_size) {
    int largest;
    if (left(i) < heap_size && numbers[left(i)] > numbers[i]) {
        largest = left(i);
    } else {
        largest = i;
    }
    if (right(i) < heap_size && numbers[right(i)] > numbers[largest]) {
        largest = right(i);
    }
    if (largest != i) {
        int temp = numbers[i];
        numbers[i] = numbers[largest];
        numbers[largest] = temp;
        heapify(numbers, largest, array_size);
    }
}

void buildHeap(int *numbers, int array_size) {
    heap_size = array_size;
    for (int i = array_size / 2 - 1; i >= 0; i--) {
        heapify(numbers, i, array_size);
    }
}

//Функция сортировки на куче
//Необходимо реализовать данную функцию.
//Результат должен быть в массиве numbers.
void heapSort(int *numbers, int array_size) {
    buildHeap(numbers, array_size);
    for (int i = array_size - 1; i >= 1; i--) {
        int temp = numbers[i];
        numbers[i] = numbers[0];
        numbers[0] = temp;
        heap_size--;
        heapify(numbers, 0, array_size);
    }
}

//Не удалять и не изменять метод main без крайней необходимости.
//Необходимо добавить комментарии, если все же пришлось изменить метод main.
int main() {
    //Объект для работы с файлами
    ReadWriter rw;

    int *brr = nullptr;
    int n;

    //Ввод из файла
    n = rw.readInt();

    brr = new int[n];
    rw.readArray(brr, n);

    //Запуск сортировки, ответ в том же массиве (brr)
    heapSort(brr, n);

    //Запись в файл
    rw.writeArray(brr, n);

    //освобождаем память
    delete[] brr;

    return 0;
}
